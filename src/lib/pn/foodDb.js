// AUTOGENERADO desde food_list.csv — lista inicial (guía)
const DB = [
  {
    "name": "Huevos",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Pescado",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Pechuga de pollo",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Pavo",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "WHEY",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Carne baja en grasa",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Cerdo bajo en grasa",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Yogurt griego",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Mariscos",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Proteína en polvo",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Queso de cabra",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Carne molida",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Queso fresco",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Hamburguesa",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Barra de proteína",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Charqui",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Salchichas de ave",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Cordero",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Nuggets",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Hamburguesa de soya",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Embutidos",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "rojo"
      }
    ]
  },
  {
    "name": "Salchichas altas en grasa",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "rojo"
      }
    ]
  },
  {
    "name": "Salame",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "rojo"
      }
    ]
  },
  {
    "name": "Fritos de pollo o carne",
    "aliases": [],
    "pieces": [
      {
        "macro": "P",
        "qty": 1,
        "calidad": "rojo"
      }
    ]
  },
  {
    "name": "Arroz blanco",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Quinoa",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Legumbres",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Papas",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Avena",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Camote",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Choclo",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Cereales integrales bajos en azúcar",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Pan integral bajo en grasas",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Galletas integrales",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Barra cereal integral",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Frutas",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Arroz integral",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Cuscus",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Barra de cereal",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Galletas",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Granola",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Leche",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Azúcar",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Miel",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Yogurt con sabor",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Leche c/sabor",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Yogurt normal",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Pan blanco",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Frutos secos",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Fruta enlatada",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Bebidas",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "rojo"
      }
    ]
  },
  {
    "name": "Golosinas",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "rojo"
      }
    ]
  },
  {
    "name": "Jugos de fruta",
    "aliases": [],
    "pieces": [
      {
        "macro": "C",
        "qty": 1,
        "calidad": "rojo"
      }
    ]
  },
  {
    "name": "Aceite oliva extra virgen",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Palta",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Maní",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Yema de huevo",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Almendras, nueces",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Pistachos",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Aceitunas",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Quesos madurados >6 meses",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Coco sin procesar",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Aceite/leche de coco",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Chocolate negro",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Aceite de canola prensado",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Aceite de oliva",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Crema",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Mantequilla maní",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Omega 3 y aceite de algas",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Quesos madurados <6 meses",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Mantequilla",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Salsas y aderezos",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "amarillo"
      }
    ]
  },
  {
    "name": "Tocino",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "rojo"
      }
    ]
  },
  {
    "name": "Salchichas/chorizo",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "rojo"
      }
    ]
  },
  {
    "name": "Aceite de maíz",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "rojo"
      }
    ]
  },
  {
    "name": "Aceite de girasol",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "rojo"
      }
    ]
  },
  {
    "name": "Nutella",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "rojo"
      }
    ]
  },
  {
    "name": "Margarina",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "rojo"
      }
    ]
  },
  {
    "name": "Queso laminado procesado",
    "aliases": [],
    "pieces": [
      {
        "macro": "G",
        "qty": 1,
        "calidad": "rojo"
      }
    ]
  },
  {
    "name": "Pimentón rojo",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Tomate",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Betarraga",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Ají",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Rabanitos",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Berenjena",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Repollo morado",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Lechuga morada",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Cebolla morada",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Rúcula",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Acelga",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Espinacas",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Alcachofa",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Espárragos",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Apio",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Coles de Bruselas",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Porotos verdes",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Pepino",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Kale",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Repollo",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Brócoli",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Pimentón verde",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Lechuga",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Zapallo",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Pimentón naranja",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Zanahoria",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Cebolla",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Champiñón",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Ajo",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Rábano",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Coliflor",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  },
  {
    "name": "Pimentón amarillo",
    "aliases": [],
    "pieces": [
      {
        "macro": "V",
        "qty": 1,
        "calidad": "verde"
      }
    ]
  }
];

// --- helpers de búsqueda tolerante (sin tildes, minúsculas, espacios normalizados)
const normalize = (s) =>
  (s || '')
    .toString()
    .normalize('NFD')               // separa diacríticos
    .replace(/[\u0300-\u036f]/g, '')// elimina tildes/diacríticos
    .toLowerCase()
    .replace(/\s+/g, ' ')
    .trim();

// Precompute: guardamos nombre y alias normalizados una sola vez
for (const it of DB) {
  it._n = normalize(it.name);
  it._a = (it.aliases || []).map(normalize);
}


export function lookupFood(q) {
  if (!q) return [];
  const s = normalize(q);

  const hits = [];
  for (const it of DB) {
    const name = it._n;
    const aliases = it._a;

    let score = 0;
    if (name === s) score = 4;                 // match exacto
    else if (name.startsWith(s)) score = 3;    // empieza con
    else if (name.includes(s)) score = 2;      // contiene

    // alias: priorizamos exacto > empieza > contiene
    let aliasScore = 0;
    for (const a of aliases) {
      if (a === s) { aliasScore = 3; break; }
      if (a.startsWith(s)) aliasScore = Math.max(aliasScore, 2.5);
      else if (a.includes(s)) aliasScore = Math.max(aliasScore, 1.5);
    }
    score = Math.max(score, aliasScore);

    if (score > 0) hits.push({ it, score });
  }

  // orden: mejor score, luego nombres más cortos (más específicos), luego alfabético
  hits.sort((a, b) =>
    b.score - a.score ||
    a.it.name.length - b.it.name.length ||
    a.it.name.localeCompare(b.it.name, 'es')
  );

  return hits.map(h => h.it).slice(0, 50);
}


export const FOOD_DB_LOCAL = DB;
export default DB;
